# R-Data-Exploration-Data-Visualization
# 1.Download the file ‘parkingLA2017.csv’ from our class Blackboard site.
# 2.Read this file into your R environment a. What are the dimensions of this dataframe? 
pk<-read.csv('D:/R datasets/parkingLA2017.csv')
View(pk)
dim(pk)
# 3. Filter the dataframe. Create a new object that only contains data for your assigned “Make” of car.For the next set of questions, use this new dataframe. a. What are the dimensions of this new dataframe that only contains the rows for your assigned “Make” of car?
library(dplyr)
PLYM<-filter(pk, Make=='PLYM')
View(PLYM)
dim(PLYM)
# 4. Dealing with missing values: a) Are there any missing values in your dataset? b) Does the variable RP.State.Plate contain any missing values? 
anyNA(PLYM)
anyNA(PLYM$RP.State.Plate)
# 4.c) Find and display the standard deviation for the variable Fine.amount. Does the variable Fine.amount contain any missing values? To deal with this issue, perform an imputation by replacing the NAs with a reasonable alternative. Now, find and display the standard deviation for this variable again.
sd(PLYM$Fine.amount)
anyNA(PLYM$Fine.amount)
PLYM$Fine.amount[is.na(PLYM$Fine.amount)] <- mean(PLYM$Fine.amount, na.rm=TRUE)
sd(PLYM$Fine.amount)
# 4.d) Replace any blank cells in the Location column with NA.
PLYM[PLYM$Location=='']<-NA 
# 4.e) Now, remove all of the records that contain “NA” for AGENCY.SHORT.NAME from your dataset.
library(tidyr)
PLYM<- PLYM %>% drop_na(AGENCY.SHORT.NAME)
str(PLYM)
PLYM$Issue.Date<-as.Date(PLYM$Issue.Date)
str(PLYM)
# 5. Dealing with the Date data type
View(PLYM)
PLYM<-arrange(PLYM,Issue.Date)
View(PLYM)

Dates<-subset(PLYM, select=Issue.Date,Issue.Date>='2017-11-01' & Issue.Date<='2017-11-30')
View(Dates)

PLYM<-select(PLYM,-Ticket.number) 
View(PLYM)

summarize(PLYM,min(Fine.amount),quantile(Fine.amount, 0.25),median(Fine.amount),quantile(Fine.amount, 0.75), max(Fine.amount),mean(Fine.amount)) 

VD<-table(PLYM$Violation.Description)
View(VD)

library(dplyr)
PLYM2<-filter(PLYM,Violation.Description %in% 
                   c("NO PARK/STREET CLEAN","DISPLAY OF TABS",
                     "METER EXP.","PARKED OVER TIME LIMIT",
                     "RED ZONE"))
View(PLYM2)

library(ggplot2)
ggplot(PLYM2,aes(x=Violation.Description))+geom_bar(fill=rainbow(n=5))+ggtitle("Number of Occurrences for top 5 Violations")

p1<-group_by(PLYM2,AGENCY.SHORT.NAME)
p2<-summarize(p1,avgsize=mean(Fine.amount))
p2
ggplot(p2,aes(x=AGENCY.SHORT.NAME,y=avgsize))+
  geom_bar(stat = "identity",fill=rainbow(n=7))+
  ggtitle("Average fine sizes of agencies")

PLYM2$AGENCY.SHORT.NAME<-as.factor(PLYM2$AGENCY.SHORT.NAME)
ggplot(PLYM2,aes(x=AGENCY.SHORT.NAME,y=Fine.amount))+geom_violin()+ggtitle("Fine amounts of agencies")

ggplot(PLYM2,aes(x=Issue.time,fill=Violation.Description))+geom_histogram(bins=24)+
  ggtitle("Frequency of Ticket Issuances Per Hour ")

